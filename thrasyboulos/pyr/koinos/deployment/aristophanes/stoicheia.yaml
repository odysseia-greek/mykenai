# thrasyboulos/pyr/koinos/stoicheia/aristophanes.yaml
- op: add
  path: /spec/template/spec/containers/-
  value:
      name: "aristophanes"
      image: ghcr.io/odysseia-greek/aristophanes:v0.6.3
      env:
          - name: POD_NAME
            valueFrom:
                fieldRef:
                    fieldPath: metadata.name
          - name: NAMESPACE
            valueFrom:
                fieldRef:
                    fieldPath: metadata.namespace
          - name: ELASTIC_SEARCH_USER
            valueFrom:
                secretKeyRef:
                    name: agreus-elastic
                    key: user
          - name: ELASTIC_SEARCH_PASSWORD
            valueFrom:
                secretKeyRef:
                    name: agreus-elastic
                    key: password
      ports:
          - containerPort: 50052
      envFrom:
        - configMapRef:
            name: odysseia-common-env
      imagePullPolicy: Always
      resources:
          requests:
              memory: 32Mi
              cpu: 50m
          limits:
              memory: 64Mi
      volumeMounts:
          - name: elastic-internal-tls
            mountPath: /app/config/elastic
            readOnly: true