apiVersion: v1
kind: ConfigMap
metadata:
  name: elastic-roles-and-cnp
data:
  api: |
    cnp_rules:
      - method: "^POST$"
        path: "^/%%index%%/_search(\\?.*)?$"
      - method: "^POST$"
        path: "^/_search/scroll(\\?.*)?$"
      - method: ^GET$
        path: ^/%%index%%/_doc/.*$

  seeder: |
    cnp_rules:
      - method: "^DELETE$"
        path: "^/%%index%%$"
      - method: "^PUT$"
        path: "^/%%index%%$"
      - method: "^PUT$"
        path: "^/_ilm/policy/%%index%%_policy$"
      - method: "^PUT$"
        path: "^/%%index%%/_create$"
      - method: "^POST$"
        path: "^/%%index%%/_bulk$"
      - method: "^POST$"
        path: "^/%%index%%/_doc(\\?.*)?$"

  hybrid: |
    cnp_rules:
      - method: "^DELETE$"
        path: "^/%%index%%$"
      - method: "^GET$"
        path: "^/%%index%%$"
      - method: "^PUT$"
        path: "^/%%index%%$"
      - method: "^PUT$"
        path: "^/_ilm/policy/%%index%%_policy$"
      - method: "^PUT$"
        path: "^/%%index%%/_create$"
      - method: "^POST$"
        path: "^/%%index%%/_update/[^/]+$"
      - method: "^POST$"
        path: "^/%%index%%/_doc(\\?.*)?$"
      - method: "^POST$"
        path: "^/%%index%%/_search(\\?.*)?$"
      - method: "^POST$"
        path: "^/_search/scroll(\\?.*)?$"

  alias: |
    cnp_rules:
      - method: "^DELETE$"
        path: "^/%%index%%$"
      - method: "^PUT$"
        path: "^/%%index%%$"
      - method: "^PUT$"
        path: "^/%%index%%(-[0-9]{4}\\.[0-9]{2}\\.[0-9]{2})?$"
      - method: "^PUT$"
        path: "^/%%index%%(-[0-9]{4}\\.[0-9]{2}\\.[0-9]{2})/_aliases/%%index%%$"
      - method: "^PUT$"
        path: "^/_ilm/policy/%%index%%_policy$"
      - method: "^PUT$"
        path: "^/%%index%%/.*$"
      - method: "^POST$"
        path: "^/%%index%%/_bulk$"

  creator: |
    cnp_rules:
      - method: "^PUT$"
        path: "^/%%index%%/_create/.*$"
      - method: "^POST$"
        path: "^/%%index%%/_bulk$"
